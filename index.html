<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>PinkyMan Gon</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <!-- Bootstrap Icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic"
    rel="stylesheet" type="text/css" />
  <!-- SimpleLightbox plugin CSS-->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link rel="stylesheet" href="css/style.css" />
  <style>
    .info-section {
      margin-bottom: 20px;
      color: #fff;
    }

    .title {
      font-size: 1.5em;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 1.2em;
      font-weight: bold;
      margin-bottom: 5px;
      position: relative;
    }

    .subtitle.text {
      margin-bottom: 10px;
      text-align: left;
      /* 內容左對齊 */
    }

    .important {
      color: var(--bs-primary);
    }


    #map {
      display: flex;
      justify-content: center;
      /* 水平置中 */
      align-items: center;
      /* 垂直置中 */
    }

    #map iframe {
      border-radius: 10px;
      /* 讓地圖顯示有圓角效果 */
      width: 100%;
      /* 設置地圖寬度為100% */
      max-width: 100%;
      /* 確保地圖不會超出容器 */
      height: 450px;
      /* 設置固定高度 */
    }

    #map .container {
      max-width: 1200px;
      /* 設置容器的最大寬度 */
      margin: 0 auto;
      /* 使容器水平居中 */
    }

    @media (max-width: 768px) {
      #map iframe {
        height: 300px;
        /* 在小屏幕上設置地圖的高度 */
      }
    }
  </style>
</head>

<body id="page-top">
  <!-- Navigation-->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3" id="mainNav">
    <div class="container px-4 px-lg-5">
      <a class="navbar-brand" href="#page-top">PinkyMan Gon</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse"
        data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ms-auto my-2 my-lg-0">
          <li class="nav-item">
            <a class="nav-link" href="#about">活動公告</a>
          </li>
          <!--
          <li class="nav-item">
            <a class="nav-link" href="#portfolio">GON</a>
          </li>
          -->
          <li class="nav-item">
            <a class="nav-link" href="#apply">預約登記</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#map">店家資訊</a>
          </li>

        </ul>
      </div>
    </div>
  </nav>
  <!-- Masthead-->
  <header class="masthead">
    <div class="container px-4 px-lg-5 h-100">
      <div class="row gx-4 gx-lg-5 h-100 align-items-center justify-content-center text-center">
        <div class="col-lg-8 align-self-end">
          <h1 class="text-white font-weight-bold">
            PinkyMan Gon
          </h1>
          <hr class="divider" />
        </div>
        <div class="col-lg-8 align-self-baseline">
          <p class="text-white-75 mb-5">
            簡單的活動說明內容 也可以放活動時間
          </p>
          <a class="btn btn-dark btn-xl" href="#about">前往活動公告</a>
        </div>
      </div>
    </div>
  </header>
  <!-- About-->
  <section class="page-section bg-primary" id="about">
    <div class="container px-4 px-lg-5">
      <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-lg-8 text-center">
          <h2 class="text-white mt-0">
            活動公告
          </h2>
          <hr class="divider divider-light" />
          <div class="text-white-75 mb-4">
            <div class="info-section">
              <div class="text">我們是OOO！</div>
            </div>
            <div class="info-section">
              <div class="subtitle">💖辦生咖的原因</div>
              <div class="text">由於場地大小的關係，再加上我們採用非包場模式，所以店家會開放部分給一般民眾入內。為了控制店內人數，我們決定採用預約表單的方式來進行活動！</div>
            </div>
            <div class="info-section">
              <div class="subtitle">💛預約事項 ૮꒰˶ฅ́˘ฅ̀˶꒱ა</div>
              <div class="text">每一批次人數有限，活動時間為2小時</div>
              <div class="text">如果該時段的預約已滿，請另改其他時間進行預約</div>
              <div class="text">預約是否成功以信箱收到的信件為主</div>
              <div class="text">預約失敗請另改時間進行活動預約</div>
            </div>
            <div class="info-section">
              <div class="subtitle">🤍活動參與規則</div>
              <div class="text">為了讓皮皮們都能參與到活動，一天請勿預約超過一個梯次，但歡迎預約不同日來一起參與活動ᯓᡣ𐭩.ᐟ ⊹</div>
              <div class="text">臨時決定來參與的皮皮也可以在現場排隊，前一批的人離開或有多餘空位的時候，才會開放給現場排隊的皮皮入內ㄛ！</div>
            </div>
            <div class="info-section">
              <div class="subtitle">❤️應援禮發放 ପ꒰⑅•ᴗ•｡꒱໊♡</div>
              <div class="text">以使用表單線上預約成功的皮皮為主，有多餘的應援才會開放給現場排隊的皮皮領取，數量有限，發完為止！</div>
            </div>
            <div class="info-section">
              <div class="subtitle">💙店家資訊 ⊹₊ ⋆</div>
              <div class="text">地點：旁邊納涼 日式刨冰 Kakigori<br>106 台北市大安區延吉街131巷1弄20號</div>
              <div class="text">營業時間：12:00 - 20:00<br><span class="important">(休勾問題：禮拜二是12:00開始嗎還是14:00)</span></div>
            </div>
            <div class="info-section">
              <div class="subtitle">💜活動梯次時間 ꒰ᐢ. .ᐢ꒱₊˚⊹</div>
              <div class="text">活動日期：8/6 - 8/11</div>
              <div class="text">第一梯次 12:00 - 14:00</div>
              <div class="text">第二梯次 14:00 - 16:00</div>
              <div class="text">第三梯次 16:00 - 18:00</div>
              <div class="text">第四梯次 18:00 - 20:00</div>
              <div class="text">(每日皆有四個梯次，如果該梯次預約人數額滿，將不會顯示在表單內)</div>
            </div>
            <div class="info-section">
              <div class="subtitle">🧡表單統計時間</div>
              <div class="text">7/12 - 8/2止</div>
            </div>
            <div class="info-section">
              <div class="subtitle">💕注意事項</div>
              <div class="text">由於活動是採預約制，如果有晚到或臨時無法到場的情形，請事先告知主辦進行取消預約。</div>
              <div class="text">開放入場前如未到場，主辦會先聯絡表單內留下的聯絡資訊進行通知，如未到場也未回覆的人，將自動取消預約並開放名額給現場排隊的皮皮，請不要造成店家及主辦的困擾！！</div>
            </div>
            <div class="info-section">
              <div class="subtitle">🤎聯絡資訊</div>
              <div class="text">如有對生咖的相關問題都能哀居私訊OOO，我們將儘快為您解答！<br><span class="important">(休勾問題：需要說現場有互動遊戲嗎)</span>
              </div>
            </div>

          </div>

          <a class="btn btn-light btn-xl" href="#apply">前往預約登記</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Portfolio-->
  <div id="portfolio">
    <div class="container-fluid p-0">
      <div class="row g-0">
        <div class="col-lg-4 col-sm-6">
          <a class="portfolio-box" href="images/gon1.jpg" title="哈利奎剛">
            <img class="img-fluid" src="images/gon1.jpg" alt="..." />
            <div class="portfolio-box-caption">
              <div class="project-category text-white-50">
                GON
              </div>
              <div class="project-name">哈利奎剛</div>
            </div>
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a class="portfolio-box" href="images/gon2.jpg" title="偷偷跟你說">
            <img class="img-fluid" src="images/gon2.jpg" alt="..." />
            <div class="portfolio-box-caption">
              <div class="project-category text-white-50">
                GON
              </div>
              <div class="project-name">偷偷跟你說</div>
            </div>
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a class="portfolio-box" href="images/gon3.jpg" title="最愛VVS">
            <img class="img-fluid" src="images/gon3.jpg" alt="..." />
            <div class="portfolio-box-caption">
              <div class="project-category text-white-50">
                GON
              </div>
              <div class="project-name">最愛VVS</div>
            </div>
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a class="portfolio-box" href="images/gon4.jpg" title="阿~~~救救我">
            <img class="img-fluid" src="images/gon4.jpg" alt="..." />
            <div class="portfolio-box-caption">
              <div class="project-category text-white-50">
                GON
              </div>
              <div class="project-name">阿~~~救救我</div>
            </div>
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a class="portfolio-box" href="images/gon5.jpg" title="我死了...">
            <img class="img-fluid" src="images/gon5.jpg" alt="..." />
            <div class="portfolio-box-caption">
              <div class="project-category text-white-50">
                GON
              </div>
              <div class="project-name">我死了...</div>
            </div>
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a class="portfolio-box" href="images/gon6.jpg" title="我跳~">
            <img class="img-fluid" src="images/gon6.jpg" alt="..." />
            <div class="portfolio-box-caption p-3">
              <div class="project-category text-white-50">
                GON
              </div>
              <div class="project-name">我跳~</div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
  <!-- Call to action-->
  <!--
  <section class="page-section bg-dark text-white">
    <div class="container px-4 px-lg-5 text-center">
      <h2 class="mb-4">Free Download at Start Bootstrap!</h2>
      <a class="btn btn-light btn-xl" href="https://startbootstrap.com/theme/creative/">Download Now!</a>
    </div>
  </section>
  -->

  </section>
  <!-- apply-->
  <section class="page-section" id="apply">
    <div class="container px-4 px-lg-5">
      <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-lg-8 col-xl-6 text-center">
          <h2 class="mt-0">一起來慶祝 곤듀 的生日吧 !</h2>
          <hr class="divider" />
          <p class="text-muted mb-5">
            準備好一起來參與了嗎? 快來預約登記唷!
          </p>
        </div>
      </div>
      <div class="row gx-4 gx-lg-5 justify-content-center mb-5">
        <div class="col-lg-6">
          <form id="applyForm" data-sb-form-api-token="API_TOKEN">
            <!-- Email address input-->
            <div class="form-floating mb-3">
              <input class="form-control" id="email" type="email" data-sb-validations="required,email" />
              <label for="email">電子郵件</label>
              <div class="invalid-feedback" data-sb-feedback="email:required">
                *請輸入電子郵件
              </div>
              <div class="invalid-feedback" data-sb-feedback="email:email">
                *必須輸入有效的電子郵件地址
              </div>
            </div>
            <!-- 選擇場次 input-->
            <div class="form-floating mb-3">
              <select id="round" name="round" class="form-control form-select" data-sb-validations="required">
                <!-- 其他選項將由JavaScript動態添加 -->
              </select>
              <label for="round">選擇參加的場次</label>
              <div class="invalid-feedback" data-sb-feedback="round:required">
                *請選擇場次。
              </div>
            </div>
            <!-- 預約人數 input-->
            <p style="font-size: 12px;color:var(--bs-primary);">
              *注意選擇場次剩餘人數
              (若填寫超過人數會預約失敗唷！)
            </p>
            <div class="form-floating mb-3">
              <input class="form-control" id="count" type="number" data-sb-validations="required" />
              <label for="count">預約的人數</label>

              <div class="invalid-feedback" data-sb-feedback="count:required">
                *請輸入預約人數。
              </div>
              <div class="invalid-feedback" data-sb-feedback="count:max">*預約人數不能超過剩餘名額唷</div>
            </div>
            <!-- mangon_count input-->
            <div class="form-floating mb-3">
              <input class="form-control" id="mangon_count" type="number" data-sb-validations="required" />
              <label for="mangon_count">ManGon 生日套餐份數</label>
              <div class="invalid-feedback" data-sb-feedback="mangon_count:required">
                *請輸入份數,若沒有請填0。
              </div>
            </div>
            <!-- mangon_count input-->
            <div class="form-floating mb-3">
              <input class="form-control" id="pinky_count" type="number" data-sb-validations="required" />
              <label for="pinky_count">Pinkyman Gon 生日套餐份數</label>
              <div class="invalid-feedback" data-sb-feedback="pinky_count:required">
                *請輸入份數,若沒有請填0。
              </div>
            </div>
            <!-- Name input-->
            <div class="form-floating mb-3">
              <input class="form-control" id="name" type="text" data-sb-validations="required" />
              <label for="name">暱稱</label>
              <div class="invalid-feedback" data-sb-feedback="name:required">
                *請輸入暱稱
              </div>
            </div>
            <!-- SNS input-->
            <div class="form-floating mb-3">
              <input class="form-control" id="sns" type="text" data-sb-validations="required" />
              <label for="sns">社群 ( IG / LINE社群名稱 )
              </label>
              <div class="invalid-feedback" data-sb-feedback="sns:required">
                *社群聯絡方式
              </div>
            </div>
            <!-- Phone number input-->
            <div class="form-floating mb-3">
              <input class="form-control" id="phone" type="tel" data-sb-validations="required" />
              <label for="phone">手機號碼</label>
              <div class="invalid-feedback" data-sb-feedback="phone:required">
                *請輸入手機號碼
              </div>
            </div>
            <!-- Message input-->
            <p style="font-size: 12px;color: var(--bs-primary);">
              *若預約人數超過兩人以上麻煩填寫第二人的聯絡方式 ( IG或社群名稱 )
            </p>
            <div class="form-floating mb-3">
              <textarea class="form-control" id="message" type="text" style="height: 10rem"></textarea>
              <label for="message">備註</label>
              <div class="invalid-feedback"></div>
            </div>
            <!-- check input
            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="checkok" data-sb-validations="required">
              <label class="form-check-label" for="checkok" style="font-size: 12px;color: var(--bs-primary);">
                我已確認上述填寫內容，準備好要一起參與活動惹
              </label>
              <div class="invalid-feedback" data-sb-feedback="checkok:required">
                *確認上述填寫無誤並勾選
              </div>
            </div>
            -->
            <!-- Submit success message-->
            <!---->
            <!-- This is what your users will see when the form-->
            <!-- has successfully submitted-->
            <div class="d-none" id="submitSuccessMessage">
              <div class="text-center mb-3">
                <div class="fw-bolder">
                  Gon Xi 您預約登記成功啦~
                </div>
                將會寄送通知信給您~ 在留意一下信件唷~
                <br />
              </div>
            </div>
            <!-- Submit error message-->
            <!---->
            <!-- This is what your users will see when there is-->
            <!-- an error submitting the form-->
            <div class="d-none" id="submitErrorMessage">
              <div class="text-center text-danger mb-3">
                喔喔! 登記失敗啦
              </div>
            </div>
            <!-- Submit Button-->
            <div class="d-grid">
              <button class="btn btn-primary btn-xl disabled" id="submitButton" type="submit">
                確認登記
              </button>
            </div>
          </form>
        </div>
      </div>
      <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-lg-4 text-center mb-5 mb-lg-0">
          <div>主辦聯絡資訊：這裡可以放聯絡資訊</div>
        </div>
      </div>
    </div>
  </section>

  <!-- MAP-->
  <section class="page-section bg-primary text-white" id="map">
    <div class="container px-4 px-lg-5">
      <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-lg-8 text-center">
          <h2 class="text-white mt-0">
            店家資訊 ⊹₊ ⋆
          </h2>
          <hr class="divider divider-light" />
          <div class="text-white-75 mb-4">
            <div class="info-section text-white">
              <div class="text">地點：旁邊納涼 日式刨冰 Kakigori<br>106 台北市大安區延吉街131巷1弄20號</div>
              <div class="text">營業時間：12:00 - 20:00<br><span class="important">(休勾問題：禮拜二是12:00開始嗎還是14:00)</span></div>
            </div>

          </div>
        </div>
      </div>
      <div id="map">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3614.7308044804504!2d121.55189897537683!3d25.043208077810466!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442abc69f4addb1%3A0x24cfd43b82733ebc!2zMTA25Y-w5YyX5biC5aSn5a6J5Y2A5bu25ZCJ6KGXMTMx5be3MeW8hDIw6Jmf!5e0!3m2!1szh-TW!2stw!4v1720164343880!5m2!1szh-TW!2stw"
          width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
    </div>
  </section>



  <!-- Footer-->
  <footer class="bg-dark py-5">
    <div class="container px-4 px-lg-5">
      <div class="small text-center text-white">
        Copyright &copy; 807 - EEEEE TEAM | IN TAIWAN |
      </div>
    </div>
  </footer>
  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <!-- SimpleLightbox plugin JS-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.js"></script>
  <!-- Core theme JS-->
  <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>

  <script>
    const PROXY_URL = 'https://script.google.com/macros/s/AKfycbwjehGSjY1x7FeaKQC262R1_xh74blp6CRsUnKv6jpyBaX3Yl_SAgtLMskzKKPXcWEABA/exec';

    window.addEventListener("DOMContentLoaded", (event) => {
      // Navbar shrink function
      const navbarShrink = function () {
        const navbarCollapsible = document.body.querySelector("#mainNav");
        if (!navbarCollapsible) {
          return;
        }
        if (window.scrollY === 0) {
          navbarCollapsible.classList.remove("navbar-shrink");
        } else {
          navbarCollapsible.classList.add("navbar-shrink");
        }
      };

      // Shrink the navbar
      navbarShrink();

      // Shrink the navbar when page is scrolled
      document.addEventListener("scroll", navbarShrink);

      // Activate Bootstrap scrollspy on the main nav element
      const mainNav = document.body.querySelector("#mainNav");
      if (mainNav) {
        new bootstrap.ScrollSpy(document.body, {
          target: "#mainNav",
          rootMargin: "0px 0px -40%",
        });
      }

      // Collapse responsive navbar when toggler is visible
      const navbarToggler = document.body.querySelector(".navbar-toggler");
      const responsiveNavItems = [].slice.call(
        document.querySelectorAll("#navbarResponsive .nav-link")
      );
      responsiveNavItems.map(function (responsiveNavItem) {
        responsiveNavItem.addEventListener("click", () => {
          if (window.getComputedStyle(navbarToggler).display !== "none") {
            navbarToggler.click();
          }
        });
      });

      // Activate SimpleLightbox plugin for portfolio items
      new SimpleLightbox({
        elements: "#portfolio a.portfolio-box",
      });





    });


    async function fetchRounds() {
      try {
        const response = await fetch(PROXY_URL + '?action=getRounds');
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }

        // 檢查返回的內容是否是 JSON
        const contentType = response.headers.get('Content-Type');
        if (!contentType || !contentType.includes('application/json')) {
          // 打印響應的內容，以幫助調試
          const textResponse = await response.text();
          console.error('Expected JSON, but got:', textResponse);
          throw new Error('Expected JSON, but got something else');
        }

        // 解析 JSON
        const rounds = await response.json();
        const roundSelect = document.getElementById('round');
        // 清空之前的選項
        roundSelect.innerHTML = '';

        // 將獲取到的數據添加到選單中
        rounds.forEach((round, index) => {
          const option = document.createElement('option');
          option.value = round.round;
          option.text = round.round;
          option.setAttribute('data-max', round.max);

          roundSelect.appendChild(option);
        });

        // 设置 count 的最大值为第一个选项的 data-max
        if (roundSelect.options.length > 0) {
          const firstOption = roundSelect.options[0];
          const max = firstOption.getAttribute('data-max');
          const countInput = document.getElementById('count');
          countInput.max = max;
        }

      } catch (error) {
        console.error('Error fetching rounds:', error);
      }
    }

    document.addEventListener('DOMContentLoaded', fetchRounds);

    // 监听下拉菜单的 change 事件
    document.getElementById('round').addEventListener('change', function () {
      const selectedOption = this.options[this.selectedIndex];
      const max = selectedOption.getAttribute('data-max');
      const countInput = document.getElementById('count');

      countInput.value = ''; // 清空输入框
      countInput.max = max; // 设置最大值
    });




    // 控制 count input 超过最大值时显示错误消息
    document.getElementById('count').addEventListener('input', function () {
      const countInput = this;
      const max = countInput.max;
      if (countInput.value > max) {
        countInput.setCustomValidity(`*預約人數不能超過最大值 ${max}`);
      } else {
        countInput.setCustomValidity('');
      }
      countInput.reportValidity(); // 显示验证错误消息
    });

    document.getElementById('applyForm').addEventListener('submit', async function (event) {
      console.log('submit');
      event.preventDefault(); // 阻止表单的默认提交行为

      // 获取表单数据
      const formData = new FormData(this);
      const formObject = {};
      formData.forEach((value, key) => {
        formObject[key] = value;
      });

      try {
        // 使用 fetch 发送表单数据到 GAS
        const response = await fetch(PROXY_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formObject)
        });

        const result = await response.text();
        if (result === 'Success') {
          // 显示成功消息
          document.getElementById('submitSuccessMessage').classList.remove('d-none');
        } else {
          // 显示错误消息
          document.getElementById('submitErrorMessage').classList.remove('d-none');
        }
      } catch (error) {
        console.error('Error submitting the form:', error);
        document.getElementById('submitErrorMessage').classList.remove('d-none');
      }
    });
  </script>
</body>

</html>
